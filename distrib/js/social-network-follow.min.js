(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports);
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports);
    global.socials = mod.exports;
  }
})(this, function (exports) {

  "use strict";

  Object.defineProperty(exports, "__esModule", {
    value: true
  });

  function _classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  var _createClass = function () {
    function defineProperties(target, props) {
      for (var i = 0; i < props.length; i++) {
        var descriptor = props[i];
        descriptor.enumerable = descriptor.enumerable || false;
        descriptor.configurable = true;
        if ("value" in descriptor) descriptor.writable = true;
        Object.defineProperty(target, descriptor.key, descriptor);
      }
    }

    return function (Constructor, protoProps, staticProps) {
      if (protoProps) defineProperties(Constructor.prototype, protoProps);
      if (staticProps) defineProperties(Constructor, staticProps);
      return Constructor;
    };
  }();

  function isFunction(obj) {
    return typeof obj === "function";
  }

  if (!Array.prototype.find) {
    Array.prototype.find = function (fn) {
      var founds = this.filter(fn);
      if (founds !== null && founds.length > 0) {
        return founds[0];
      }
      return null;
    };
  }

  var getOrApply = function getOrApply(value, context, args2) {
    if (isFunction(value)) {
      return value.apply(context, [args2]);
    }
    return value;
  };

  var showLabelMinWidth = 640;
  var containerClass = "socials";
  var shareClass = "social";
  var shareLinkClass = "social-link";
  var shareLogoClass = "social-logo";
  var shareLabelClass = "social-label";

  var Follow = exports.Follow = function () {
    function Follow(config) {
      _classCallCheck(this, Follow);

      this.btns = null;
      window.on("resize", this.onWindowResize);
      this.update(config);
    }

    _createClass(Follow, [{
      key: "showLabel",
      value: function showLabel(screenWidth) {
        return screenWidth > showLabelMinWidth;
      }
    }, {
      key: "onWindowResize",
      value: function onWindowResize() {
        if (isFunction(this.showLabel)) {
          window.clearTimeout(this._resizeTimer);
          this._resizeTimer = window.setTimeout(this.render, 200);
        }
      }
    }, {
      key: "getShare",
      value: function getShare(shareName) {
        return this.config.follows.find(function (x) {
          return x.name === shareName;
        });
      }
    }, {
      key: "update",
      value: function update(config) {
        config.follows = config.follows.map(function (x) {
          var found = followTemplates.find(function (y) {
            return y.name === x.name;
          });
          if (found) {
            found.url = x.url;
          }
          return found;
        });
        this.config = Object.assign({ events: [] }, config);
        this.container = qsi(this.config.containerId);
        this.container.addClass(containerClass);
        this.render();
      }
    }, {
      key: "render",
      value: function render() {
        this._clear();
        this._showLabel = getOrApply(this.showLabel, this, screen.width);

        this.btns = newElement("span");
        this.container.beforeEnd(this.btns);
        this._renderShareButtons();
      }
    }, {
      key: "_renderShareButtons",
      value: function _renderShareButtons() {
        var ctx = this;
        this.config.follows.forEach(function (share) {
          ctx._renderShare(share);
        });
      }
    }, {
      key: "_renderShare",
      value: function _renderShare(share) {
        var btn = null;
        if (isFunction(share.renderer)) {
          btn = newElement("p", { class: shareClass }, share.renderer());
        } else {
          btn = this.createButton(share);
        }
        this.btns.beforeEnd(btn);
        btn.addClass(share.name);
      }
    }, {
      key: "createButton",
      value: function createButton(share) {
        return this.createButtonLink(share);
      }
    }, {
      key: "onShareClick",
      value: function onShareClick(share) {
        window.open(share.url);
      }
    }, {
      key: "createButtonLink",
      value: function createButtonLink(share) {
        var ctx = this;
        var link = newElement("a", { href: "#", class: shareLinkClass, title: share.tooltip || "" }, "", { click: function click() {
            ctx.onShareClick(share);
          } });
        link.beforeEnd(this.createButtonLogo(share));
        if (this.config.showLabel && this._showLabel) {
          link.beforeEnd(this.createButtonLabel(share));
          if (this.config.minWidthWithLabel) {
            link.css({ "min-width": this.config.minWidthWithLabel });
          }
        }
        if (this.config.events !== null) {
          this.config.events.forEach(function (event, handler) {
            if (isFunction(handler)) {
              link.on(event, share);
            }
          });
        }
        return link;
      }
    }, {
      key: "createButtonLogo",
      value: function createButtonLogo(share) {
        var icon = null;
        if (share.img != null) {
          icon = newElement("img", { src: share.img });
        } else {
          icon = newElement("i", { class: share.class });
        }
        icon.addClass(shareLogoClass);
        return icon;
      }
    }, {
      key: "createButtonLabel",
      value: function createButtonLabel(share) {
        return newElement("span", { class: shareLabelClass }, share.label);
      }
    }, {
      key: "_clear",
      value: function _clear() {
        window.clearTimeout(this._resizeTimer);
        this.container.html("");
      }
    }, {
      key: "destroy",
      value: function destroy() {
        this._clear();
        window.off("resize", this.onWindowResize);
        this.container.removeClass(containerClass);
      }
    }]);

    return Follow;
  }();
});